<?xml version="1.0" encoding="UTF-8"?>
<custom-sql>
	
	<sql id="com.idetronic.subur.service.persistence.SuburItemFinder.findByAndCategoryIds">
	
			EXISTS
				(
					SELECT
						1
					FROM
						AssetEntries_AssetCategories
					WHERE
						(AssetEntries_AssetCategories.entryId = AssetEntry.entryId) AND
						(AssetEntries_AssetCategories.categoryId IN ([$CATEGORY_ID$]))
				)
		
	
	
	</sql>
	<sql id="com.idetronic.subur.service.persistence.SuburItemFinder.findByAndTagIds">
		
			SELECT
				DISTINCT AssetEntries_AssetTags.entryId
			FROM
				AssetEntries_AssetTags
			WHERE
				([$TAG_ID$])
		
	
	</sql>
	<sql id="com.idetronic.subur.service.persistence.SuburItemFinder.findByAndItemTypeIds">
		
			EXISTS
				(
					SELECT
						1
					FROM
						Subur_ItemItemType
					WHERE
						(Subur_ItemItemType.itemId = AssetEntry.classPK) AND
						(Subur_ItemItemType.itemTypeId IN ([$ITEMTYPE_ID$]))
				)
		
	
	</sql>
	<sql id="com.idetronic.subur.service.persistence.ItemItemTypeFinderImpl.getItemType">
	select a.*,b.itemid from subur_itemtype a
	inner join subur_itemitemtype b
		on a.itemtypeid = b.itemtypeid
		and b.itemid = ?
	
	
	</sql>
	<sql id="com.idetronic.subur.service.persistence.SuburItemFinderImpl.findByAuthor_G">
		SELECT * FROM Subur_Item
			LEFT JOIN Subur_ItemAuthor ON Subur_ItemAuthor.itemId = Subur_Item.itemId
		WHERE Subur_ItemAuthor.authorId = ?
		AND Subur_Item.groupId = ?
		AND Subur_Item.status = ?
		ORDER BY Subur_Item.publishedDate DESC
	
	</sql>
	
	<sql id="com.idetronic.subur.service.persistence.SuburItemFinderImpl.getItemType">
		select * from subur_ItemItemType a, subur_ItemType b
		where a.itemId = ?
		and a.itemTypeId = b.itemTypeId
	</sql>
	<sql id="com.idetronic.subur.service.persistence.SuburItemFinderImpl.getItemDetails">
		SELECT 
		  * 
		FROM 
		  subur_item, 
		  subur_metadatapropertyvalue
		WHERE 
		  subur_item.itemid = subur_metadatapropertyvalue.itemid
		  and subur_item.itemid=?
	</sql>
	
	<sql id="com.idetronic.subur.service.persistence.SuburItemFinderImpl.getItemAuthors">
		select * from subur_itemauthor , subur_author 
			where subur_itemauthor.authorid = subur_author.authorid
			and subur_itemauthor.itemid = ?
	
	</sql>
	<sql id="com.idetronic.subur.service.persistence.SuburItemFinderImpl.getFileEntries">
		SELECT 
		  * 
		FROM 
		  subur_fileentrytype, 
		  subur_itemfileentry
		WHERE 
		  subur_fileentrytype.typeid = subur_itemfileentry.entrytype
		  and subur_itemfileentry.itemid=?
	
	
	</sql>
	
	
	
	<sql id="com.idetronic.subur.service.persistence.AuthorFinderImpl.findByFirstName">
	
		SELECT * FROM
			Subur_Author
		WHERE
			[$WHERE$]
			(lower(Subur_Author.firstName) LIKE ? )
		ORDER BY 
			Subur_Author.firstName ASC
	
	
	</sql>
	<sql id="com.idetronic.subur.service.persistence.AuthorFinderImpl.findByName">
	
		SELECT * FROM
			Subur_Author
		WHERE
			(lower (Subur_Author.firstName) LIKE ?) OR (lower(Subur_Author.lastName) LIKE ?)
		AND companyId = ?
		AND groupId = ?
		ORDER BY 
			Subur_Author.firstName ASC
	
	
	</sql>
	<sql id="com.idetronic.subur.service.persistence.AuthorFinderImpl.byFirstNameAndLastName">
		SELECT * FROM
			Subur_Author
		WHERE
			(lower (Subur_Author.firstName) LIKE ?) AND (lower(Subur_Author.lastName) LIKE ?)
		AND companyId = ?
		AND groupId = ?
		ORDER BY 
			Subur_Author.firstName ASC
	
	</sql>
	<sql id="com.idetronic.subur.service.persistence.AuthorFinderImpl.countFirstNameAndLastName">
		SELECT count(*) as total FROM
			Subur_Author
		WHERE
			(lower (Subur_Author.firstName) LIKE ?) AND (lower(Subur_Author.lastName) LIKE ?)
		AND companyId = ?
		AND groupId = ?

	
	</sql>
	
	<sql id="com.idetronic.subur.service.persistence.AuthorFinderImpl.totalByName">
	
		SELECT count(*) as total FROM
			Subur_Author
		WHERE
			(lower (Subur_Author.firstName) LIKE ?) OR (lower(Subur_Author.lastName) LIKE ?)
			AND companyId = ?
			AND groupId = ?
		
	
	
	</sql>
	<sql id="com.idetronic.subur.service.persistence.AuthorFinderImpl.countItemByGroupCompany">
		SELECT subur_itemauthor.authorid, 
       Count(*) AS itemTotal 
		FROM   subur_itemauthor 
		       INNER JOIN subur_author 
		               ON subur_author.authorid = subur_itemauthor.authorid 
		WHERE  subur_author.companyid = ? 
		       AND subur_author.groupid = ? 
		GROUP  BY subur_itemauthor.authorid 
	</sql>
	<sql id="com.idetronic.subur.service.persistence.AuthorFinderImpl.findByCompanyGroup">
		SELECT * FROM Subur_Author
	
		WHERE companyId = ?
		AND groupId = ? 
		AND lastPublishedDate IS NOT NULL
		ORDER BY lastPublishedDate DESC
	</sql>
	<!--  Expertise finder -->
	<sql id="com.idetronic.subur.service.persistence.ExpertiseFinder.findByGroupName">
	         
		SELECT * FROM 
			Subur_Expertise
		
		WHERE 
			[$GROUP_ID$]
			Subur_Expertise.indexedName LIKE ? OR ? IS NULL
		ORDER BY Subur_Expertise.indexedName ASC
	
	</sql>
	
	<!--  end expertise finder -->
	
</custom-sql>